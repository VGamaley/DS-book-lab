# Модуль 1. Базовий. Лабораторна робота №1. Створення основи типового Data Science-проєкту{#modul1}

__Мета:__ _"Швидкий старт" для створення бази Data Science-проекту у середовищі `R-Studio` [@R-Studio] із застосуванням концепції "грамотного програмування" засобами мови програмування `R` [@R-base], пакету RMarkdown та системи комп'ютерної верстки LaTeX_. 


## Що ви будете вміти?

* виконувати експорт/імпорт даних, елеменарну їх обробку, візуалізацію даних та результатів обчислень засобами мови R у середовищі IDE RStudio.
* Створювати електронний документ (у форматах html, pdf, doc) на кшталт того, __який ви зараз читаєте__ (інтерактивне меню, можливість показати/сховати код і т. ін.).
* використовувати засоби редактору LaTeX для набору формул, наприклад, як ця: $y(x)=b_0+b_1x+b_2x^2$.
* створювати бібліографічну базу даних засобами [BibTeX](https://ru.wikipedia.org/wiki/BibTeX), яка автоматично формує розділ посилань 'References', як __у цьому посібнику__.


## Короткі теоретичні відомості

### Що таке Data Science-проект?

Будь-який Data Science-проект (альтернативна назва -- Data Mining-проект) має на меті реалізацію на практиці методології [CRISP DM](https://www.the-modeling-agency.com/crisp-dm.pdf) [@CRISP_DM]. Згідно зі стандартом CRISP-DM 1.0 життєвий цикл проекту Data Mining має складатися з шести фаз (рис. 1):  
-	розуміння бізнес-процесів (business understanding);  
-	розуміння даних (data understanding);  
-	підготовка даних (data preparation);  
-	моделювання (modeling);  
-	оцінка (evaluation);  
-	розгортання (deployment).  

![_Рис. 1. Життєвий цикл процесу Data Mining згідно з методологією CRISP _](image\CRISP_DM.jpg)

__Фаза розуміння__ бізнес-процесів включає наступні задачі:  
-	визначення бізнес-цілей;  
-	визначення ситуації;  
-	визначення цілей  Data Mining;  
-	створення плану проекта.  
__Фаза розуміння__ даних включає наступні задачі:  
-	первинний збір даних;  
-	опис даних;  
-	вивчення даних;  
-	перевірка якості даних.  
__Фаза підготовки__ даних включає в себе всі дії, пов’язані з остаточним  формуванням набору даних для аналізу. При цьому виконуються п’ять задач:  
-	вибір даних;  
-	очищення даних;  
-	конструювання даних;  
-	інтеграція даних;  
-	форматування даних.  
__Фаза моделювання__ -– призначена для вибору оптимального методу побудови моделей і настроювання його параметрів  для отримання оптимальних  рішень. На даній фазі вирішуються наступні задачі:  
-	вибір методу моделювання;  
-	генерація тестового проекту;  
-	створення моделей;  
-	оцінка моделей.  
__Фаза оцінки__ -– призвана більш ґрунтовно оцінити модель до процесу її остаточного розміщення, щоб впевнитись у досяжності поставлених бізнес-цілей. Дана фаза включає наступні задачі:  
-	оцінка результатів;  
-	 перегляд процесу;  
-	визначення подальших дій.  
__Фаза розгортання__ передбачає розгортання моделі.  

Якщо виділити з даного процесу суто технологічну складову, то типова технологічна основа будь-якого Data Science-проекту має виглядати наступним чином [@r4ds] (рис. 2).  

![_Рис. 2. Структура типового Data Science-проекту_ [@r4ds] ](image\process_DS.png)

Перша задача _імпорту даних_ (__Import__) полягає у  вилученні необхідних сирих даних з будь-яких джерел (файли, БД, дані з датчиків у реальному часі і т. д.) самого різного формату.  

Друга задача (__Tidy__) -- _приведення даних до_ так званого  _"охайного" вигляду_, придатного для аналізу. Як правило мова йде про приведення даних до табличного вигляду "ключ-значення", або, іншими словами, "об'єкт-ознака". Дана процедура є частиною більш загальної задачі підготовки даних до аналізу (__Wrangling, Munging__), яка включає інші процедури, наприклад, заповнення пропущених значень (Missing Value Emputation), вилучення неінформативних даних (data reduction), різного роду трансформації (__Transforming__) і т. ін. Тобто, __Tiding+Transforming=Wrangling(Munging)__.    

Тріада задач _трансформація-візуалізація-моделювання_ (__Transform-Visualise-Model__) складаює ядро Data Mining-процесу, суть якого полягає в пошуку нетривіальних практично корисних закономірностей в даних шляхом висування і перевірки гіпотез, побудови різного роду моделей, який обов'язково супроводжується візуалізацією як проміжних, так і кінцевих результатів моделювання, що предоставляються замовнику. Саме ця тріада задач забезпечує фази розуміння (__Understanding__) даних, моделей та паттернів, що знаходяться в даних і створюють основу монетизованого продукту інтелектуального аналізу даних.  

Останній етап -- подання проміжних чи остаточних  результатів інтелектуального аналізу даних (__Сommunicate__) іншим членам команди, які задіяні у проекті, у зручному для сприйняття вигляді з використанням прози, таблиць, графіків та коду.  

Для реалізації типового Data Science-проекту необхідний відповідний інструментарій, який би був гнучким і задовольняв всім необхідним вимогам, котрих потребують вищезгадані задачі, і давав би можливість розв'язати будь-яку задачу без значних витрат часу, в першу чергу, на маніпулювання даними та підготовку результатів.  

Мова і середовище програмування R з великим арсеналом програмних пакетів, IDE RStudio та технологія так званого _грамотного програмування_ дозволяє ефективну реалізацію всіх етапів типового Data Science-проекту, об'єднавши всі задачі в єдине ціле. 


### Концепція грамотного програмування

Подання проміжних чи остаточних результатів проекту може бути виконано у тому чи іншому вигляді: звіту, презентації, методичних вказівок, наукової статті тощо,  в одному з поширених форматів: .doc, pdf, .html тощо.

Протягом багатьох років у наукових та ділових колах стандартом де-факто є застосування так званої парадигми [_грамотного програмування_](https://en.wikipedia.org/wiki/Literate_programming) для підготовки електронних документів з використанням у тому числі і потужніх засобів комп'ютерної графіки. З виникненням і розвитком Data Science, методологію грамотного програмування було взято на озброєння і реалізоване практично в кожному потужному інструменті Data Science.

_Грамотне програмування_ (Literate Programming) -- концепція, методологія програмування і документування, в якій програма складається з прози на природній мові упереміж з макропідстановками і кодом на мовах програмування.

В основі технології грамотного програмування лежить поняття _динамічного документу_ -- текстового документу, який складається з тексту та коду, з використанням необхідних мов програмування, який дозволяє згенерувати власне електронний документ заданого формату. При цьому використовуються як можливості мов розмітки документів (напр. Markdown, YAML, HTML, LaTeX), так і можливості доступу до потужних програмних  бібліотек, призначених для обробки даних та комп'ютерної графіки.

Таким чином, логічно мати певне програмне середовище, яке дозволить поєднати низку таких технологій разом і створити зручний інтерфейс розробника. Існують різні програмні засоби і середовища [(IDE, Integrated Development Environment, інтегроване середовище розробки)](https://uk.wikipedia.org/wiki/%D0%86%D0%BD%D1%82%D0%B5%D0%B3%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B5_%D1%81%D0%B5%D1%80%D0%B5%D0%B4%D0%BE%D0%B2%D0%B8%D1%89%D0%B5_%D1%80%D0%BE%D0%B7%D1%80%D0%BE%D0%B1%D0%BA%D0%B8), що дозволяють реалізувати технологію грамотного програмування. 

У даній лабораторній роботі пропонується низка наразі актуальних і популярних інструментів для створення динамічних документів (рис. 3):

* IDE [R Studio](https://www.rstudio.com/) [@R-Studio] як інтегроване середовище розробки;

* спеціалізовану мову програмування [R](https://cran.r-project.org/) [@R-base] та арсенал її потужніх бібліотек -- для маніпулювання даними та візуалізації результатів;

* фреймворк [RMarkdown](http://rmarkdown.rstudio.com/) [@R-rmarkdown] -- для підготовки динамічних звітів мовою розмітки  [Markdown](https://uk.wikipedia.org/wiki/Markdown); (див.[@CheatSheetMarkdown] та шпаргалку у RStudio: _"Help\\Cheat_Sheets"_); також покрокове керівництво [Д. Омельченко](https://rpubs.com/domelia/828777); також див. [R Markdown: продолжение. Подготовка рукописи научной статьи](https://rpubs.com/domelia/834925);

* мову розмітки даних [LaTex](https://uk.wikipedia.org/wiki/LaTeX) для високоякісного оформлення наукових документів.

![_Рис. 3. Структура процесу підготовки електронного документу наукового чи ділового характеру в парадигмі грамотного програмування (literate programming)_](image\process.png)


### Markdown і RMarkdown

__Markdown__ (МФА: [маркдаун]) -- полегшена мова розмітки даних, яку створено з ухилом на прочитність та зручність у публікації з подальшим перетворенням її на structurally valid XHTML або HTML.

Такі сайти, як GitHub, Reddit та Stack Overflow використовують Markdown для полегшення обговорень між користувачами.

__R Markdown__ [@RMark] -- фреймворк R, який дозволяє створювати динамічні Markdown-документи у середовищі IDE RStudio в стилі грамотного програмування з використанням всіх можливих потужностей мови R та її бібліотек. Дозволяє реалізовувати інтерфейс так званих ноутбуків для створення документів з текстом та кодом разом для виготовлення елегантно відформатованого виводу. Дозволяє використовувати декілька мов, включаючи R, Python, С++, HTML, SQL, [Stan](http://mc-stan.org/). Через  конвертор [Pandoc](http://pandoc.org/) дозволяє здійснювати вивід у html, doc або pdf формат у вигляді веб-сторінок, брошюр, буклетів, слайдів.


### Інсталяція R

Для цього необхідно зайти на [CRAN](https://cran.r-project.org/), скачати і  встановити актуальну версію R. Даний дистрибутив R має свій GUI, однак його можливості досить обмежені. Тут, у розділі 'Contributed', також можна знайти безліч цікавої літератури, написаної різними мовами.   

Одне з найкоротших і доступних введень у мову R можна знайти на сторінці [Дмитра Храмова](http://dkhramov.dp.ua/Comp.R.html#.Wpetc1rFJdj). Зокрема, ознайомитися з [елементами базової графіки](http://dkhramov.dp.ua/images/edu/Stu.WebMining/ch04_graphics.pdf).


### Інсталяція RStudio

Для зручної роботи і відладки програм, зокрема роботи з фреймворком RMarkdown для створення динамічного документу, необхідно встановити IDE [RStudio](https://www.rstudio.com/products/rstudio/download/).   

### Створення RMarkdown-документу {#CreateRMarkdown}

1. Завантажити RStudio.

2. Створити RMarkdown-документ у форматі [R Notebook](http://rmarkdown.rstudio.com/r_notebooks.html), вибравши відповідний пункт [меню](https://prnt.sc/gkpes4).


### Генерація електронного документу

Генерація електронного документу здійснюється натисканням комбінації _Ctrl+Shift+K_.


## Приклад створення Markdown-документу

### Постановка задачі

Побудувати графік функції $y(x)=b_ox+b_1+b_2x^2$ для діапазону $x \in [x_1;x_2]$.


### Виконання завдання


1. Створюємо документ R Markdown, як описано вище у п. [_Створення RMarkdown-документу_](#CreateRMarkdown).

2. Налаштовуємо потрібним чином YAML-заголовок документу, у якому задаються метадані всього документу (рис. 4).

![_Рис. 4. Вигляд YAML-заголовку для документу, який ви зараз читаєте_](image\YAML.png)

3. Для набору формул використовуємо `LaTeX` згідно з правилами [його синтаксису](https://en.wikibooks.org/wiki/LaTeX/Mathematics). Формула у RMarkdown-документі має бути взята у символи $:

`$y(x)=b_ox+b_1+b_2x^2$`


3. Пишемо код на R засобами базової графіки у відповідній зоні, яка називається чанком \@ref(fig:fig_1):


```{r fig_1, fig.cap='Example fig.', out.width='80%', fig.asp=.75, fig.align='center'}

# Задаємо параметри функції
b0 <- 2
b1 <- 3
b2 <- 1.57

# Задаємо область визначення

x <- seq(-1, 1, .1)
y <- b0 + b1 * x + b2 * x^2

plot(x, y,
     type = "l",
     col = "red",
     main = "Графік функції",
     xlab = "x",
     ylab = "y"
     )
points(x, y,
       col = "blue")

df <- data.frame(x = x, y = y) # створюємо таблицю даних

```
4. Продемонструємо можливості пакету `rio` [@R-rio] для експорту (імпорту) даних на диск (з диску).

```{r}
# install.packages("rio") # інсталяція пакету
library(rio) # підключення пакету
export(df, "data/data.csv")

```
5. Виконуємо імпорт даних із файлу і візуалізацію у вигляді таблиці \@ref(tab:tab_1). 

```{r tab_1, tidy=FALSE}
dfNew <-  import("data/data.csv")

# Таблиця засобами knitr
knitr::kable(head(dfNew),
             caption = "_Табл. 1. Фрагмент таблиці даних_")


# Таблиця засобами stargazer
# stargazer::stargazer(head(dfNew),
#                      type = "html",
#                      summary = FALSE,
#              title = "_Табл. 1. Фрагмент таблиці даних_")


# Таблиця засобами xtable
# print(xtable::xtable(head(dfNew),
#                      type = "html",
#                      html.table.attributes="border=0",
#                      summary = FALSE,
#              caption = "_Табл. 1. Фрагмент таблиці даних_"))

```

6. Формуємо результуючу таблицю.

_Табл. 2. Параметри функції_

Параметр | Значення
-----|-----
$b_0$| `r b0`
$b_1$| `r b1`
$b_2$| `r b2`
$x_1$| `r min(x)`
$x_2$| `r max(x)`


### Індивідуальні завдання на лабораторну роботу

Видає викладач.


### Домашнє завдання

1. Ознайомитися з можливостями пакету `ggplot2` [@ggplot2].

2. Оптимізувати код, наведений у даній методичці, за допомогою потокового оператора `%>%` засобами пакету `ggplot2`.

3. Побудувати графік функції засобами пакету `ggplot2`. [@R-ggplot2]


